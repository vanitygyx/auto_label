Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: False
Training/evaluation parameters Namespace(adam_epsilon=1e-08, adv_epsilon=1.0, adv_name='word_embeddings', cache_dir='', config_name='', crf_learning_rate=5e-05, data_dir='datasets\\cluener', device=device(type='cuda'), do_adv=True, do_eval=False, do_lower_case=False, do_predict=False, do_train=True, eval_all_checkpoints=False, eval_max_seq_length=512, evaluate_during_training=False, fp16=False, fp16_opt_level='O1', gradient_accumulation_steps=1, id2label={0: 'X', 1: 'B-address', 2: 'B-book', 3: 'B-company', 4: 'B-game', 5: 'B-government', 6: 'B-movie', 7: 'B-name', 8: 'B-organization', 9: 'B-position', 10: 'B-scene', 11: 'I-address', 12: 'I-book', 13: 'I-company', 14: 'I-game', 15: 'I-government', 16: 'I-movie', 17: 'I-name', 18: 'I-organization', 19: 'I-position', 20: 'I-scene', 21: 'S-address', 22: 'S-book', 23: 'S-company', 24: 'S-game', 25: 'S-government', 26: 'S-movie', 27: 'S-name', 28: 'S-organization', 29: 'S-position', 30: 'S-scene', 31: 'O', 32: '[START]', 33: '[END]'}, label2id={'X': 0, 'B-address': 1, 'B-book': 2, 'B-company': 3, 'B-game': 4, 'B-government': 5, 'B-movie': 6, 'B-name': 7, 'B-organization': 8, 'B-position': 9, 'B-scene': 10, 'I-address': 11, 'I-book': 12, 'I-company': 13, 'I-game': 14, 'I-government': 15, 'I-movie': 16, 'I-name': 17, 'I-organization': 18, 'I-position': 19, 'I-scene': 20, 'S-address': 21, 'S-book': 22, 'S-company': 23, 'S-game': 24, 'S-government': 25, 'S-movie': 26, 'S-name': 27, 'S-organization': 28, 'S-position': 29, 'S-scene': 30, 'O': 31, '[START]': 32, '[END]': 33}, learning_rate=5e-05, local_rank=-1, logging_steps=200, loss_type='ce', markup='bios', max_grad_norm=1.0, max_steps=-1, model_name_or_path='prev_trained_model\\bert-base-chinese', model_type='bert', n_gpu=1, no_cuda=False, num_train_epochs=3.0, output_dir='outputs\\output_ours_1108bert', overwrite_cache=False, overwrite_output_dir=True, per_gpu_eval_batch_size=32, per_gpu_train_batch_size=32, predict_checkpoints=0, save_steps=200, seed=42, server_ip='', server_port='', task_name='cluener', tokenizer_name='', train_max_seq_length=128, warmup_proportion=0.1, weight_decay=0.01)
Loading features from cached file datasets\cluener\cached_crf-train_bert-base-chinese_128_cluener
***** Running training *****
  Num examples = 10748
  Num Epochs = 3
  Instantaneous batch size per GPU = 32
  Total train batch size (w. parallel, distributed & accumulation) = 32
  Gradient Accumulation steps = 1
  Total optimization steps = 1008
Loading features from cached file datasets\cluener\cached_crf-dev_bert-base-chinese_512_cluener
***** Running evaluation  *****
  Num examples = 1343
  Batch size = 32


***** Eval results  *****
 acc: 0.7672 - recall: 0.7520 - f1: 0.7595 - loss: 8.8582 
***** Entity results  *****
******* address results ********
 acc: 0.6268 - recall: 0.5898 - f1: 0.6077 
******* book results ********
 acc: 0.7534 - recall: 0.7143 - f1: 0.7333 
******* company results ********
 acc: 0.8254 - recall: 0.6878 - f1: 0.7504 
******* game results ********
 acc: 0.7641 - recall: 0.7356 - f1: 0.7496 
******* government results ********
 acc: 0.7628 - recall: 0.8462 - f1: 0.8023 
******* movie results ********
 acc: 0.8154 - recall: 0.7020 - f1: 0.7544 
******* name results ********
 acc: 0.8377 - recall: 0.8882 - f1: 0.8622 
******* organization results ********
 acc: 0.8111 - recall: 0.7139 - f1: 0.7594 
******* position results ********
 acc: 0.7704 - recall: 0.8060 - f1: 0.7878 
******* scene results ********
 acc: 0.6777 - recall: 0.7847 - f1: 0.7273 
Saving model checkpoint to outputs\output_ours_1108bert\checkpoint-200
Saving optimizer and scheduler states to outputs\output_ours_1108bert\checkpoint-200


Loading features from cached file datasets\cluener\cached_crf-dev_bert-base-chinese_512_cluener
***** Running evaluation  *****
  Num examples = 1343
  Batch size = 32


***** Eval results  *****
 acc: 0.8037 - recall: 0.7581 - f1: 0.7802 - loss: 7.8599 
***** Entity results  *****
******* address results ********
 acc: 0.6728 - recall: 0.5845 - f1: 0.6255 
******* book results ********
 acc: 0.8054 - recall: 0.7792 - f1: 0.7921 
******* company results ********
 acc: 0.7936 - recall: 0.7831 - f1: 0.7883 
******* game results ********
 acc: 0.7956 - recall: 0.8576 - f1: 0.8254 
******* government results ********
 acc: 0.8193 - recall: 0.8259 - f1: 0.8226 
******* movie results ********
 acc: 0.8699 - recall: 0.7086 - f1: 0.7810 
******* name results ********
 acc: 0.8340 - recall: 0.8860 - f1: 0.8592 
******* organization results ********
 acc: 0.8270 - recall: 0.7166 - f1: 0.7679 
******* position results ********
 acc: 0.9187 - recall: 0.6790 - f1: 0.7809 
******* scene results ********
 acc: 0.7043 - recall: 0.7751 - f1: 0.7380 
Saving model checkpoint to outputs\output_ours_1108bert\checkpoint-400
Saving optimizer and scheduler states to outputs\output_ours_1108bert\checkpoint-400
Loading features from cached file datasets\cluener\cached_crf-dev_bert-base-chinese_512_cluener
***** Running evaluation  *****
  Num examples = 1343
  Batch size = 32


***** Eval results  *****
 acc: 0.7805 - recall: 0.7803 - f1: 0.7804 - loss: 7.6515 
***** Entity results  *****
******* address results ********
 acc: 0.6048 - recall: 0.6810 - f1: 0.6406 
******* book results ********
 acc: 0.8158 - recall: 0.8052 - f1: 0.8105 
******* company results ********
 acc: 0.7795 - recall: 0.7857 - f1: 0.7826 
******* game results ********
 acc: 0.7767 - recall: 0.8373 - f1: 0.8059 
******* government results ********
 acc: 0.8223 - recall: 0.8057 - f1: 0.8139 
******* movie results ********
 acc: 0.8438 - recall: 0.7152 - f1: 0.7742 
******* name results ********
 acc: 0.8542 - recall: 0.8817 - f1: 0.8677 
******* organization results ********
 acc: 0.7983 - recall: 0.7875 - f1: 0.7929 
******* position results ********
 acc: 0.8228 - recall: 0.7829 - f1: 0.8024 
******* scene results ********
 acc: 0.7386 - recall: 0.6220 - f1: 0.6753 
Saving model checkpoint to outputs\output_ours_1108bert\checkpoint-600
Saving optimizer and scheduler states to outputs\output_ours_1108bert\checkpoint-600


Loading features from cached file datasets\cluener\cached_crf-dev_bert-base-chinese_512_cluener
***** Running evaluation  *****
  Num examples = 1343
  Batch size = 32


***** Eval results  *****
 acc: 0.7867 - recall: 0.7878 - f1: 0.7872 - loss: 7.5622 
***** Entity results  *****
******* address results ********
 acc: 0.6402 - recall: 0.6059 - f1: 0.6226 
******* book results ********
 acc: 0.8200 - recall: 0.7987 - f1: 0.8092 
******* company results ********
 acc: 0.7931 - recall: 0.7910 - f1: 0.7921 
******* game results ********
 acc: 0.7890 - recall: 0.8746 - f1: 0.8296 
******* government results ********
 acc: 0.8132 - recall: 0.8462 - f1: 0.8294 
******* movie results ********
 acc: 0.8382 - recall: 0.7550 - f1: 0.7944 
******* name results ********
 acc: 0.8507 - recall: 0.8946 - f1: 0.8721 
******* organization results ********
 acc: 0.7784 - recall: 0.7657 - f1: 0.7720 
******* position results ********
 acc: 0.8084 - recall: 0.7991 - f1: 0.8037 
******* scene results ********
 acc: 0.7475 - recall: 0.7081 - f1: 0.7273 
Saving model checkpoint to outputs\output_ours_1108bert\checkpoint-800
Saving optimizer and scheduler states to outputs\output_ours_1108bert\checkpoint-800
Loading features from cached file datasets\cluener\cached_crf-dev_bert-base-chinese_512_cluener
***** Running evaluation  *****
  Num examples = 1343
  Batch size = 32


***** Eval results  *****
 acc: 0.7990 - recall: 0.7982 - f1: 0.7986 - loss: 7.5063 
***** Entity results  *****
******* address results ********
 acc: 0.6464 - recall: 0.6568 - f1: 0.6516 
******* book results ********
 acc: 0.8267 - recall: 0.8052 - f1: 0.8158 
******* company results ********
 acc: 0.8100 - recall: 0.8122 - f1: 0.8111 
******* game results ********
 acc: 0.8147 - recall: 0.8644 - f1: 0.8388 
******* government results ********
 acc: 0.8134 - recall: 0.8826 - f1: 0.8466 
******* movie results ********
 acc: 0.8500 - recall: 0.7881 - f1: 0.8179 
******* name results ********
 acc: 0.8710 - recall: 0.8860 - f1: 0.8785 
******* organization results ********
 acc: 0.7983 - recall: 0.7875 - f1: 0.7929 
******* position results ********
 acc: 0.8221 - recall: 0.7898 - f1: 0.8057 
******* scene results ********
 acc: 0.7460 - recall: 0.6746 - f1: 0.7085 
Saving model checkpoint to outputs\output_ours_1108bert\checkpoint-1000
Saving optimizer and scheduler states to outputs\output_ours_1108bert\checkpoint-1000


 global_step = 1008, average loss = 10.302835845284992
Saving model checkpoint to outputs\output_ours_1108bert
